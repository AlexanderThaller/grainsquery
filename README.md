# grainsquery

Parse salt grain files fetch from the saltmaster. Can aggergate, filter and
generate reports based on the grains.

## Usage
```
grainsquery 2.2.0
Alexander Thaller <alexander.thaller@trivago.com>
Parse grain files generated by salt, check grains, generate reports.

USAGE:
    grainsquery [OPTIONS] [SUBCOMMAND]

FLAGS:
    -h, --help
            Prints help information

        --version
            Prints version information


OPTIONS:
        --cache.file <file>
            file to use for caching the result of the grains file parsing

        --cache.force_refresh <bool>
            if true the cache will be forcefully refreshed

        --cache.git_dir <path>
            path to the git dir from which the current git commit hash will be read

        --cache.use <bool>
            if true we will use and generate a cachefile specified by cache,file

    -a, --filter.application <environment>
            filter out all minions that don't have the given application

        --filter.application.mode <mode>
            the mode of the application filter which specifies if you want all minions that have one of the given application or all
            application (default is one)
    -e, --filter.environment <environment>
            filter out all minions that are not in the given environment

    -i, --filter.id <id>
            filter out all minions that don't match the given id (allows regex)

    -n, --filter.id.inverse <inverse>
            reverts the filter for the id and prints all minions that don't match the id if true

    -p, --filter.ip <ip>
            filter out all minions that dont have the given ip

    -V, --filter.virtual <type>
            filter out all minions without the given virtualization type

    -f, --filter.os_family <os_family>
            filter out all minions that don't use the given operating systems

    -u, --filter.productname <productname>
            filter out all minions that don't use the given productname

    -r, --filter.realm <realm>
            filter out all minions that are not in the given realm

    -R, --filter.role <role>
            filter out all minions without the given role

    -o, --filter.roles <role>...
            filter out all minions which don't have the given role (multiple occurences possible)

        --filter.roles.mode <mode>
            the mode of the roles filter which specifies if you want all minions that have one of the given roles or all roles
            (default is one)
    -m, --filter.saltmaster <environment>
            filter out all minions that don't connect to the given saltmaster

    -s, --filter.saltversion <version>
            filter out all minions that are not using the given salt version

    -S, --filter.serialnumber <serialnumber>
            filter out all minions without the given serialnumber

    -U, --filter.structure <structure>
            filter out all minions without the given structure

        --folder.grains <folder>
            folder from which to read the grain files

    -l, --log.level <level>
            the loglevel to run under


SUBCOMMANDS:
    aggregate
            aggregate over certain aspects of the minions

    help
            Prints this message or the help of the given subcommand(s)

    list
            show minions which where parsed from the grains

    report
            generate a report out the grain files

    ssh_hosts
            generate ssh hosts file from grains

    validate
            show warnings (missing roles, environment, realm, etc.) about the parsed grains
```
